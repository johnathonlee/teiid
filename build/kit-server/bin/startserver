#!/bin/sh

#
# ##COPYRIGHT##
#
# This script will start the hostcontroller and all defined VM's for that host.
# The default behavior is to start all components defined for the host
# in the configuration.


# -----------------------------------------------------------------------------------------
#	startserver {-config <hostidentifier> | -help} {-noprocesses} 
#
# Options:
#
# 		-config <hostidentifier>  The hostidentifier is the name given to this host configuration within the 
#							MetaMatrix Configuration file. If omitted, the fully-qualified 
#							host name is used, derived from InetAddress.  If the value passed 
#							can not be found in the configuration, an attempt is made to resolve
#							it to the physical host name or IP address. 
#
# 		-noprocesses  - If present, no processes will be started, only the hostcontroller.
#                               
# 		-help  - If present, will display the available command line arguments that can be used
#
# Examples: startserver -config 192.168.1.1 
# 
#           The configuration must either contain a host segment with the value passed in (e.g., IP Address) 
#		    or must contain a name for which the value is resolved to (e.g, Host Name or IP Address). 
#
# Examples: startserver -noprocesses
# 
#           This command will start only the hostcontroller.  To start the processes, either
#		    run startserver (without the -noprocesses argument) or svcmgr.sh (.cmd).
#
#
#
#
# -----------------------------------------------------------------------------------------

#

# resolve links - $0 may be a softlink
LOC="$0"

while [ -h "$LOC" ] ; do
  ls=`ls -ld "$LOC"`
  link=`expr "$ls" : '.*-> \(.*\)$'`
  if expr "$link" : '.*/.*' > /dev/null; then
    LOC="$link"
  else
    LOC=`dirname "$LOC"`/"$link"
  fi
done

LOCDIR=`dirname "$LOC"`
PRGDIR=`cd "$LOCDIR"; pwd`

cd ${PRGDIR}

. ./mmenv.sh

if [ $# -gt 3 ] ; then
	echo "startserver only accepts upto 3 arguments, $# arguments were passed."
	echo "Usage: startserver {-config <hostidentifier> | -help} {-noprocesses} "
	
	exit 1
fi

case `uname -s` in

	AIX) 
	    ${MM_JAVA} -Xmx128m com.metamatrix.server.HostController $* &
	;;
	*)  
	    ${MM_JAVA} -server -Xmx128m com.metamatrix.server.HostController $* &
	;;
esac    



