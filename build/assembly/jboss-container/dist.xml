<!--This script builds a JAR for the Embedded Server Installation -->
<assembly>
  
  <id>jboss-dist</id>
  
  <formats>
    <format>zip</format>
  </formats>
  
  <includeBaseDirectory>false</includeBaseDirectory>
  <baseDirectory>teiid-${version}</baseDirectory>

  <fileSets>
          
    <fileSet>
        <directory>build/target/kits/jboss-container</directory>
        <outputDirectory>/</outputDirectory>      
        <includes>
          <include>**/*.sh</include>
        </includes>   
        <fileMode>755</fileMode>      
    </fileSet> 
          
    <fileSet>
        <directory>build/target/kits/jboss-container</directory>
        <outputDirectory>/</outputDirectory>      
        <excludes>
          <exclude>**/*.sh</exclude>
        </excludes>      
    </fileSet>
          
    <!-- only true dependency file for any client --> 
    <fileSet>
      <directory>target/distribution</directory>
      <includes>
        <include>teiid-${version}-client.jar</include>
      </includes>
      <outputDirectory>lib</outputDirectory>      
    </fileSet>
    
  </fileSets>
  
  <!--  these have external dependent clients like connectors-->
  <moduleSets>
    <moduleSet>
      <includes>
      	<include>org.jboss.teiid:teiid-hibernate-dialect</include>   
      </includes>
      <binaries>
		<includeDependencies>false</includeDependencies>
		<unpack>false</unpack>
        <outputDirectory>lib</outputDirectory>
      </binaries>
    </moduleSet>

    <!-- These are Teiid internal dependencies; to make JCA work -->
    <moduleSet>
        <includeSubModules>true</includeSubModules>

        <includes>
            <include>org.jboss.teiid:teiid-jboss-integration</include>            
        </includes>

        <binaries>
            <includeDependencies>true</includeDependencies>
            <unpack>false</unpack>
            <dependencySets>
                <dependencySet>
                    <useProjectArtifact>true</useProjectArtifact>
                    <unpack>false</unpack>
                    <useTransitiveDependencies>true</useTransitiveDependencies>
                    <useDefaultExcludes>true</useDefaultExcludes>
                </dependencySet>
            </dependencySets>
            <outputDirectory>deployers/teiid.deployer</outputDirectory>
        </binaries>
    </moduleSet>
    
    <!-- These are built in connectors  -->
    <moduleSet>
        <includeSubModules>true</includeSubModules>
               
        <includes>
            <include>org.jboss.teiid.connectors:translator-jdbc</include>
            <include>org.jboss.teiid.connectors:translator-loopback</include>
            <include>org.jboss.teiid.connectors:translator-file</include>
            <include>org.jboss.teiid.connectors:connector-file:rar</include>
            <include>org.jboss.teiid.connectors:translator-ldap</include>
            <include>org.jboss.teiid.connectors:connector-ldap:rar</include>
            <include>org.jboss.teiid.connectors:translator-salesforce</include>
            <include>org.jboss.teiid.connectors:connector-salesforce:rar</include>
            <include>org.jboss.teiid.connectors:connector-ws:rar</include>
            <include>org.jboss.teiid.connectors:translator-xml</include>
        </includes>

        <binaries>        
          <includeDependencies>false</includeDependencies>
          <unpack>false</unpack>
          <outputDirectory>deploy/teiid/connectors</outputDirectory>
        </binaries>
      
    </moduleSet>
        
    <!-- Include the JOPR plugin -->    
    <moduleSet>
        <includeSubModules>true</includeSubModules>
               
        <includes>
            <include>org.jboss.teiid:teiid-console</include>
        </includes>

        <binaries>        
          <includeDependencies>false</includeDependencies>
          <unpack>false</unpack>
          <outputDirectory>deploy/admin-console.war/plugins</outputDirectory>
        </binaries>
      
    </moduleSet>        
    </moduleSets>  
</assembly>